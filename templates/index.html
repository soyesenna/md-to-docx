<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT ÎãµÎ≥Ä to DOCX Î≥ÄÌôòÍ∏∞</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            overflow: hidden;
        }
        
        .header {
            background-color: white;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            color: #333;
            font-size: 24px;
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 140px);
            padding: 20px;
            gap: 20px;
        }
        
        .editor-section, .preview-section {
            flex: 1;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .section-header {
            padding: 15px 20px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            font-weight: 500;
            color: #495057;
        }
        
        .upload-button {
            margin-bottom: 10px;
        }
        
        .file-input {
            display: none;
        }
        
        .file-input-label {
            display: inline-block;
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .file-input-label:hover {
            background-color: #45a049;
        }
        
        .editor-textarea {
            flex: 1;
            padding: 20px;
            border: none;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            outline: none;
        }
        
        .preview-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
        }
        
        /* Markdown Preview Styles */
        .preview-content h1 { margin: 20px 0 15px; color: #333; }
        .preview-content h2 { margin: 18px 0 12px; color: #444; }
        .preview-content h3 { margin: 16px 0 10px; color: #555; }
        .preview-content h4 { margin: 14px 0 8px; color: #666; }
        .preview-content h5 { margin: 12px 0 6px; color: #777; }
        .preview-content h6 { margin: 10px 0 5px; color: #888; }
        
        .preview-content p { margin: 10px 0; }
        .preview-content ul, .preview-content ol { margin: 10px 0; padding-left: 30px; }
        .preview-content li { margin: 5px 0; }
        
        .preview-content pre {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .preview-content code {
            background-color: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
        }
        
        .preview-content pre code {
            background-color: transparent;
            padding: 0;
        }
        
        .preview-content blockquote {
            border-left: 4px solid #ddd;
            padding-left: 20px;
            margin: 15px 0;
            color: #666;
        }
        
        .preview-content table {
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .preview-content th, .preview-content td {
            border: 1px solid #ddd;
            padding: 8px 12px;
        }
        
        .preview-content th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        
        .preview-content img {
            max-width: 100%;
            height: auto;
        }
        
        .preview-content a {
            color: #2196F3;
            text-decoration: none;
        }
        
        .preview-content a:hover {
            text-decoration: underline;
        }
        
        /* Math block styles */
        .math-block {
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .action-bar {
            background-color: white;
            padding: 20px;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .convert-button {
            padding: 12px 40px;
            background-color: #2196F3;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .convert-button:hover:not(:disabled) {
            background-color: #1976D2;
        }
        
        .convert-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .loading {
            display: none;
            margin-left: 20px;
        }
        
        .spinner {
            display: inline-block;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2196F3;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        
        .error-message {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .success-message {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>GPT ÎãµÎ≥Ä ‚Üí DOCX Î≥ÄÌôòÍ∏∞</h1>
    </div>
    
    <div class="main-container">
        <div class="editor-section">
            <div class="section-header">
                <div class="upload-button">
                    <input type="file" id="fileInput" class="file-input" accept=".md,.markdown" />
                    <label for="fileInput" class="file-input-label">üìÅ Markdown ÌååÏùº Ïó¥Í∏∞</label>
                </div>
                <div>Markdown Ìé∏ÏßëÍ∏∞</div>
            </div>
            <textarea id="markdownEditor" class="editor-textarea" placeholder="Ïó¨Í∏∞Ïóê MarkdownÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...

# Ï†úÎ™© 1
## Ï†úÎ™© 2

- Î™©Î°ù Ìï≠Î™© 1
- Î™©Î°ù Ìï≠Î™© 2

**ÍµµÏùÄ ÌÖçÏä§Ìä∏** ÏôÄ *Í∏∞Ïö∏ÏûÑ ÌÖçÏä§Ìä∏*

[ÎßÅÌÅ¨](https://example.com)

## ÏàòÏãù ÏòàÏ†ú

Ïù∏ÎùºÏù∏ ÏàòÏãù: $E = mc^2$

Î∏îÎ°ù ÏàòÏãù:
$$
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
$$

ÌñâÎ†¨:
$$
\begin{pmatrix}
a & b \\
c & d
\end{pmatrix}
$$"></textarea>
        </div>
        
        <div class="preview-section">
            <div class="section-header">ÎØ∏Î¶¨Î≥¥Í∏∞</div>
            <div id="preview" class="preview-content"></div>
        </div>
    </div>
    
    <div class="action-bar">
        <button id="convertButton" class="convert-button">DOCXÎ°ú Î≥ÄÌôò Î∞è Îã§Ïö¥Î°úÎìú</button>
        <span class="loading" id="loading">
            <span class="spinner"></span>
            Î≥ÄÌôò Ï§ë...
        </span>
        <div class="message error-message" id="errorMessage"></div>
        <div class="message success-message" id="successMessage"></div>
    </div>
    
    <script>
        const markdownEditor = document.getElementById('markdownEditor');
        const preview = document.getElementById('preview');
        const fileInput = document.getElementById('fileInput');
        const convertButton = document.getElementById('convertButton');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        
        // Marked.js ÏÑ§Ï†ï
        marked.setOptions({
            breaks: true,
            gfm: true,
            headerIds: true,
            mangle: false,
            pedantic: false,
            smartypants: false,
            highlight: function(code, lang) {
                return code;
            }
        });
        
        // KaTeX Î†åÎçîÎßÅ ÏòµÏÖò
        const katexOptions = {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false},
                {left: '\\(', right: '\\)', display: false},
                {left: '\\[', right: '\\]', display: true}
            ],
            throwOnError: false,
            trust: true
        };
        
        // ÏàòÏãù Î∏îÎ°ù Ï†ÑÏ≤òÎ¶¨ Ìï®Ïàò
        function preprocessMath(text) {
            // Î©ÄÌã∞ÎùºÏù∏ $$ ... $$ Î∏îÎ°ùÏùÑ <div>Î°ú Í∞êÏã∏ÏÑú Î≥¥Ìò∏
            let processedText = text.replace(/\n?\$\$([\s\S]*?)\$\$\n?/g, function(match, math) {
                // ÏàòÏãù ÎÇ¥Ïö©ÏùÑ divÎ°ú Í∞êÏã∏ÏÑú Î∞òÌôò
                return '\n<div class="math-block">$$' + math.trim() + '$$</div>\n';
            });
            
            return processedText;
        }
        
        // Ïã§ÏãúÍ∞Ñ ÌîÑÎ¶¨Î∑∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updatePreview() {
            const markdownText = markdownEditor.value;
            if (markdownText.trim() === '') {
                preview.innerHTML = '<p style="color: #999;">ÎØ∏Î¶¨Î≥¥Í∏∞Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§...</p>';
            } else {
                // ÏàòÏãù Ï†ÑÏ≤òÎ¶¨
                const mathProcessed = preprocessMath(markdownText);
                
                // Markdown ÌååÏã±
                preview.innerHTML = marked.parse(mathProcessed);
                
                // KaTeXÎ°ú ÏàòÏãù Î†åÎçîÎßÅ
                if (typeof renderMathInElement !== 'undefined') {
                    renderMathInElement(preview, katexOptions);
                }
            }
        }
        
        // ÏóêÎîîÌÑ∞ ÏûÖÎ†• Ïù¥Î≤§Ìä∏
        markdownEditor.addEventListener('input', updatePreview);
        
        // ÌååÏùº ÏóÖÎ°úÎìú Ïù¥Î≤§Ìä∏
        fileInput.addEventListener('change', async function(e) {
            const file = e.target.files[0];
            if (file) {
                try {
                    const text = await file.text();
                    markdownEditor.value = text;
                    updatePreview();
                    hideMessages();
                } catch (error) {
                    showError('ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            }
        });
        
        // Î≥ÄÌôò Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
        convertButton.addEventListener('click', async function() {
            const markdownText = markdownEditor.value.trim();
            
            if (!markdownText) {
                showError('Î≥ÄÌôòÌï† ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            convertButton.disabled = true;
            loading.style.display = 'inline-block';
            hideMessages();
            
            try {
                const response = await fetch('/convert-text', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ markdown: markdownText })
                });
                
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = 'document.docx';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    showSuccess('Î≥ÄÌôòÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!');
                } else {
                    const error = await response.text();
                    showError(error || 'Î≥ÄÌôò Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
                }
            } catch (error) {
                showError('ÏÑúÎ≤Ñ Ïó∞Í≤∞ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
            } finally {
                convertButton.disabled = false;
                loading.style.display = 'none';
            }
        });
        
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            successMessage.style.display = 'none';
        }
        
        function showSuccess(message) {
            successMessage.textContent = message;
            successMessage.style.display = 'block';
            errorMessage.style.display = 'none';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }
        
        function hideMessages() {
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
        }
        
        // Ï¥àÍ∏∞ ÌîÑÎ¶¨Î∑∞ ÏóÖÎç∞Ïù¥Ìä∏
        updatePreview();
        
        // KaTeX ÎùºÏù¥Î∏åÎü¨Î¶¨ Î°úÎìú ÏôÑÎ£å ÌõÑ Ïû¨Î†åÎçîÎßÅ
        window.addEventListener('load', () => {
            setTimeout(updatePreview, 100);
        });
    </script>
</body>
</html>